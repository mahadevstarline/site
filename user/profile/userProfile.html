<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8"/>
    <title>  Dashboards  | Skote - Admin & Dashboard Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description"/>
    <meta content="Themesbrand" name="author"/>
    <!-- App favicon -->
    <link rel="shortcut icon" href="https://mahadevstarline.github.io/site/assets/images/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@6.5.95/css/materialdesignicons.min.css"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.0/css/toastr.css" rel="stylesheet"/>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"
          integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>

<link href="https://mahadevstarline.github.io/site/assets/libs/bootstrap-datepicker/bootstrap-datepicker.min.css" rel="stylesheet"
          type="text/css">
    <link href="https://mahadevstarline.github.io/site/assets/libs/select2/select2.min.css" rel="stylesheet" type="text/css"/>

<!-- Bootstrap Css -->
<link href="https://mahadevstarline.github.io/site/assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
<!-- Icons Css -->
<link href="https://mahadevstarline.github.io/site/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
<!-- App Css-->
<link href="https://mahadevstarline.github.io/site/assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />
<!-- Bootstrap Css -->
    <link href="https://mahadevstarline.github.io/site/assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet"
          type="text/css"/>
    <!-- Icons Css -->
    <link href="https://mahadevstarline.github.io/site/assets/css/icons.min.css" rel="stylesheet" type="text/css"/>
    <!-- App Css-->
    <link href="https://mahadevstarline.github.io/site/assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css"/>
    <link href="https://mahadevstarline.github.io/site/assets/css/custom.css" id="app-style" rel="stylesheet" type="text/css"/>

</head>

    <body data-sidebar="dark">
        <!-- Begin page -->
    <div id="layout-wrapper">
    <header id="page-topbar">
    <div class="navbar-header">
        <div class="d-flex">
            <!-- LOGO -->
            <div class="navbar-brand-box">
                <a href="https://mahadevstarline.github.io/site/" class="logo logo-dark">
                    <span class="logo-sm">
                        <img src="https://mahadevstarline.github.io/site/assets/images/users/logo.png" alt="" height="40">
                    </span>
                    <span class="logo-lg">
                        <img src="https://mahadevstarline.github.io/site/assets/images/users/name.png" alt="" height="40">
                    </span>
                </a>

                <a href="https://mahadevstarline.github.io/site/" class="logo logo-light">
                    <span class="logo-sm">
                        <img src="https://mahadevstarline.github.io/site/assets/images/users/logo.png" alt="" height="40">
                    </span>
                    <span class="logo-lg">
                        <img src="https://mahadevstarline.github.io/site/assets/images/users/name.png" alt="" height="40">
                    </span>
                </a>
            </div>

            <button type="button" class="btn btn-sm px-3 font-size-16 header-item waves-effect" id="vertical-menu-btn">
                <i class="fa fa-fw fa-bars"></i>
            </button>

            <!-- App Search-->
        </div>

        <div class="d-flex">


            <div class="dropdown d-inline-block">
                <button type="button" class="btn header-item waves-effect" id="page-header-user-dropdown"
                        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <img class="rounded-circle header-profile-user"
                         src="https://mahadevstarline.github.io/site/assets/images/users/avatar-1.jpg"
                         alt="Header Avatar">
                    <span class="d-none d-xl-inline-block ms-1" key="t-henry">Admin</span>
                    <i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
                </button>
                <div class="dropdown-menu dropdown-menu-end">
                    <!-- item-->

                    <a class="dropdown-item d-block" href="#" data-bs-toggle="modal"
                       data-bs-target=".change-password"><i class="bx bx-wrench font-size-16 align-middle me-1"></i> <span>Change Password</span></a>

                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item text-danger" href="javascript:void();" onclick="logout()"><i class="bx bx-power-off font-size-16 align-middle me-1 text-danger"></i> <span key="t-logout">Logout</span></a>

                    <!-- Your existing HTML elements for Firebase authentication (initialize Firebase SDK, login form, etc.) -->

                    <script type="module" src="https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js"></script>
                    <script type="module" src="https://www.gstatic.com/firebasejs/9.6.6/firebase-auth.js"></script>
                    <script type="module" src="https://www.gstatic.com/firebasejs/9.6.6/firebase-firestore.js"></script>

                    <!-- Your custom JavaScript code -->
                    <script type="module" src="https://mahadevstarline.github.io/site/services/firebase.js"></script>
                    <script type="module">
                        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js";
                        import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-auth.js";
                      
                        // Firebase configuration
                        const firebaseConfig = {
                            apiKey: "AIzaSyDGzXuv1re9hpOqykP6hDH2qWVMBCtbOJE",
  authDomain: "mahadev-efece.firebaseapp.com",
  projectId: "mahadev-efece",
  storageBucket: "mahadev-efece.appspot.com",
  messagingSenderId: "483675302264",
  appId: "1:483675302264:web:c72b4b367de8817f84c08d",
  measurementId: "G-0907T7GTET"
                        };
                      
                        // Initialize Firebase
                        const app = initializeApp(firebaseConfig);
                        const auth = getAuth(app);
                      
                        // Function to handle Firebase logout
                        window.logout = function(){
                          signOut(auth)
                            .then(() => {
                              // Sign-out successful. Redirect or perform any additional actions here.
                              window.location.href = "https://mahadevstarline.github.io/site/";
                              console.log("User signed out successfully");
                            })
                            .catch(error => {
                              // An error happened. Handle the error here.
                              console.error("Error during logout:", error);
                            });
                        }
                      
                        // Your existing code for handling authentication (login, etc.)
                      </script>
                    </div>
            </div>

            <div class="dropdown d-inline-block">
                <button type="button" class="btn header-item noti-icon right-bar-toggle waves-effect">
                    <i class="bx bx-cog bx-spin"></i>
                </button>
            </div>

        </div>
    </div>
</header>

<!--  Change-Password example -->
<div class="modal fade change-password" tabindex="-1" role="dialog"
     aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="myLargeModalLabel">Change Password</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"
                        aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="change-password">
                    <div class="mb-3">
                        <label for="current_password">Current Password</label>
                        <input id="current-password" type="password"
                               class="form-control "
                               name="current_password" autocomplete="current_password"
                               placeholder="Enter Current Password" value="">
                    </div>

                    <div class="mb-3">
                        <label for="newpassword">New Password</label>
                        <input id="password" type="password"
                               class="form-control " name="password"
                               autocomplete="new_password" placeholder="Enter New Password">
                    </div>

                    <div class="mb-3">
                        <label for="userpassword">Confirm Password</label>
                        <input id="password-confirm" type="password" class="form-control" name="password_confirmation"
                               autocomplete="new_password" placeholder="Enter New Confirm password">
                    </div>

                    <div class="mt-3 d-grid">
                        <button class="btn btn-primary waves-effect waves-light UpdatePassword"
                                data-id="1"
                                type="submit">Update Password
                        </button>
                    </div>
                </form>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
    <!-- ========== Left Sidebar Start ========== -->
    <div class="vertical-menu">

        <div data-simplebar class="h-100">
    
            <!--- Sidemenu -->
            <div id="sidebar-menu">
                <!-- Left Menu Start -->
                <ul class="metismenu list-unstyled" id="side-menu">
    
                    <li>
                        <a href="https://mahadevstarline.github.io/site/dashboard" class="waves-effect">
                            <i class="bx bx-home-circle"></i>
                            <span>Home</span>
                        </a>
                    </li>
    
    
                    <li>
                        <a href="https://mahadevstarline.github.io/site/user/userList.html" class="waves-effect">
                            <i class="bx bxs-user-detail"></i>
                            <span>User Management</span>
                        </a>
                    </li>
    
    
                    <li>
    
                        <a href="https://mahadevstarline.github.io/site/markets/result.html" class="waves-effect">
                            <i class="bx bx-bullseye"></i>
                            <span>Declare Result</span>
                        </a>
                    </li>
    
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bxs-report"></i>
                            <span>Report Management</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="true">
    
                            <li><a href="https://mahadevstarline.github.io/site/reports/bids.html">Users Bid History</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/reports/sell.html">Customer Sell Report</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/reports/wins.html">Winning Report</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/reports/w_report.html">Bid Win Report</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/reports/deposit_report.html">Auto Deposit History</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bxs-wallet"></i>
                            <span>Wallet Management</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="true">
    
                            <li><a href="https://mahadevstarline.github.io/site/wallet/withdraw_list.html">Withdraw Request</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/wallet/show_add_funds.html">Add Fund (User Wallet)</a></li>
                            
                        </ul>
                    </li>
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bx-bullseye"></i>
                            <span>Games Management</span>
                        </a>
    
                        <ul class="sub-menu" aria-expanded="true">
                            <li><a href="https://mahadevstarline.github.io/site/markets/game_name.html">Game Name</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/markets/game_rates.html">Game Rates</a></li>
                        </ul>
    
            
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bx-cog"></i>
                            <span>Settings</span>
                        </a>
    
                        <ul class="sub-menu" aria-expanded="true">
                            <li><a href="https://mahadevstarline.github.io/site/settings/main.html">Main Settings</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/settings/contact.html">Contact Settings</a></li>
                        </ul>
    
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bx-bullseye"></i>
                            <span>Starline Management</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="true">
                            <li><a href="https://mahadevstarline.github.io/site/starline/index.html">Game Name</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/starline_rate.html">Game Rates</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/bid_report.html">Bid History</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/show_result.html">Declare Result</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/sell_report.html">Starline Sell Report</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/win_report.html">Starline Winning Report</a></li>
                        </ul>
                    </li>
    
                </ul>
            </div>
        </div>
    </div>

    <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content">

            <div class="page-content">

                <div class="container-fluid">
                        <div class="row">
        <div class="col-12">
            <div class="page-title-box d-flex align-items-center justify-content-between">
                <h4 class="mb-0 font-size-18">User Details</h4>

                <div class="page-title-right">
                    <ol class="breadcrumb m-0">
                        <li class="breadcrumb-item"><a href="javascript: void(0);">User Management</a></li>
                        <li class="breadcrumb-item active">User Details</li>
                    </ol>
                </div>

            </div>
        </div>
    </div>

    <div class="row row_col">
        <div class="col-xl-4">
            <div class="card overflow-hidden h100p">
                <div class="bg-soft-primary">
                    <div class="row bg-soft bg-primary">
                        <div class="col-7">
                            <div class="text-primary p-3">
                                <h5 id="priname" class="text-primary"></h5>
                                <p id="priphone">
                                </p>
                            </div>
                        </div>
                        <div class="col-5 align-center">
                            <div class="p-3 text-right">
                                <div class="mb-2">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body border-top">

                    <div class="row">
                        <div class="col-sm-12 text-center">
                            <div>
                                <p class="text-muted mb-2">Available Balance</p>
                                <h5 id="cpoint"></h5>
                            </div>

                        </div>

                        <div class="col-sm-6">
                            <div class="mt-3">
                                <button class="btn btn-success btn-sm w-lg btn-block"
                                        data-bs-toggle="modal"
                                        data-bs-target="#addFundsModal">Add Fund
                                </button>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="mt-3">
                                <button class="btn btn-danger btn-sm w-lg btn-block" 
                                        data-bs-toggle="modal"
                                        data-bs-target="#withdrawFundModel">Withdraw Fund
                                </button>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>

        <div class="col-xl-8">
            <div class="card h100p">
                <div class="card-body">
                    <h4 class="card-title mb-4">Personal Information</h4>
                    <div class="table-responsive">
                        <table id="detail" class="table table-nowrap mb-0">
                            <tbody>
                                
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>


    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Fund Deposit History</h4>
                        <div class="">
                            <table id="user_fund_deposit" class="table compact table-striped table-bordered">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Date Time</th>
                                    <th>(₹) Amount</th>
                                </tr>
                                </thead>
                                <tbody>
                                                                </tbody>
                            </table>
                        </div>
                        <div id="msg"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    

    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Withdraw Fund Request List</h4>
                        <div class="">
                            <table id="withdrawTable" class="table table-striped table-bordered">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Request Amount</th>
                                    <th>Request Date</th>
                                    <th>Status</th>
                                </tr>
                                </thead>
                                <tbody>
                                                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" id="user_id" value="2">

    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Bid History</h4>
                        <div class="">
                            <table id="bidHistoryTable" class="table table-striped table-bordered">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Date</th>
                                    <th>Game Name</th>
                                    <th>Game Type</th>
                                    <th>Session</th>
                                    <th>Points</th>
                                </tr>
                                </thead>
                                <tbody>
                                                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12 col-xl-12 col-md-12">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="card-title">Winning History Report</h4>
                                <table id="winsHistory" class="table table-striped table-bordered">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Date</th>
                                        <th>Game Name</th>
                                        <th>Game Type</th>
                                        <th>Session</th>
                                        <th>Win Points</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addFundsModal" aria-labelledby="addFundsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addFundsModalLabel">Add Fund</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id='addfunds'>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="recipient-name" class="col-form-label">Amount:</label>
                            <input type="number" class="form-control" name="amount" id="amount"
                                   placeholder="Enter Amount">
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal fade" id="withdrawFundModel" aria-labelledby="withdrawFundModelLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addFundsModalLabel">Withdraw Fund</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="withdrawfunds">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="add_amount" class="col-form-label">Amount:</label>
                            <input type="number" class="form-control" name="amount" id="amount"
                                   placeholder="Enter Amount">
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-6">
                    <script>document.write(new Date().getFullYear())</script>
                    ©Matka.
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-right d-none d-sm-block">

                    </div>
                </div>
            </div>
        </div>
    </footer>
    </div>    </div>

    <div id="snackbar"></div>
    <div id="snackbar-info"></div>
    <div id="snackbar-error"></div>
    <div id="snackbar-success"></div>

                </div>
                <!-- container-fluid -->
            </div>
            <!-- End Page-content -->
            <footer class="footer">
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-6">
                <script>document.write(new Date().getFullYear())</script> © Admin Panel.
            </div>
        </div>
    </div>
</footer>        </div>
        <!-- end main content-->
    </div>
    <!-- END layout-wrapper -->

    <!-- Right Sidebar -->
    <!-- Right Sidebar -->
<div class="right-bar">
    <div data-simplebar class="h-100">
        <div class="rightbar-title d-flex align-items-center px-3 py-4">
            
            <h5 class="m-0 me-2">Settings</h5>

            <a href="javascript:void(0);" class="right-bar-toggle ms-auto">
                <i class="mdi mdi-close noti-icon"></i>
            </a>
        </div>

        <!-- Settings -->
        <hr class="mt-0" />
        <h6 class="text-center mb-0">Choose Layouts</h6>

        <div class="p-4">
            <div class="mb-2">
                <img src="https://mahadevstarline.github.io/site/assets/images/layouts/layout-1.jpg" class="img-fluid img-thumbnail" alt="">
            </div>

            <div class="form-check form-switch mb-3">
                <input class="form-check-input theme-choice" type="checkbox" id="light-mode-switch" checked>
                <label class="form-check-label" for="light-mode-switch">Light Mode</label>
            </div>
    
            <div class="mb-2">
                <img src="https://mahadevstarline.github.io/site/assets/images/layouts/layout-2.jpg" class="img-fluid img-thumbnail" alt="">
            </div>
            <div class="form-check form-switch mb-3">
                <input class="form-check-input theme-choice" type="checkbox" id="dark-mode-switch" data-bsStyle="assets/css/bootstrap-dark.min.css" data-appStyle="assets/css/app-dark.min.css">
                <label class="form-check-label" for="dark-mode-switch">Dark Mode</label>
            </div>
    
            <div class="mb-2">
                <img src="https://mahadevstarline.github.io/site/assets/images/layouts/layout-3.jpg" class="img-fluid img-thumbnail" alt="">
            </div>
            <div class="form-check form-switch mb-5">
                <input class="form-check-input theme-choice" type="checkbox" id="rtl-mode-switch" data-appStyle="assets/css/app-rtl.min.css">
                <label class="form-check-label" for="rtl-mode-switch">RTL Mode</label>
            </div>

            <div class="mb-2">
                <img src="https://mahadevstarline.github.io/site/assets/images/layouts/layout-4.jpg" class="img-thumbnail" alt="layout images">
            </div>
            <div class="form-check form-switch mb-5">
                <input class="form-check-input theme-choice" type="checkbox" id="dark-rtl-mode-switch">
                <label class="form-check-label" for="dark-rtl-mode-switch">Dark RTL Mode</label>
            </div>
            
        </div>

    </div> <!-- end slimscroll-menu-->
</div>
<!-- /Right-bar -->

<!-- Right bar overlay-->
<div class="rightbar-overlay"></div>    <!-- /Right-bar -->

    <!-- JAVASCRIPT -->
    <!-- JAVASCRIPT -->
<script src="https://mahadevstarline.github.io/site/assets/libs/jquery/jquery.min.js"></script>
<script src="https://mahadevstarline.github.io/site/assets/libs/bootstrap/bootstrap.min.js"></script>
<script src="https://mahadevstarline.github.io/site/assets/libs/metismenu/metismenu.min.js"></script>
<script src="https://mahadevstarline.github.io/site/assets/libs/simplebar/simplebar.min.js"></script>
<script src="https://mahadevstarline.github.io/site/assets/libs/node-waves/node-waves.min.js"></script>
<script>
    document.getElementById("change-password").addEventListener("submit", async (event) => {
        event.preventDefault();
        const formData = new FormData(event.target);
        const newPassword = formData.get("password");

            try {
                const response = await fetch("https://server-9l60.onrender.com/change", {
                    method: "POST",
                    body: formData,
                });

                if (response.ok) {
                    window.location.href = "https://mahadevstarline.github.io/site/dashboard";
                    console.log("Password Changed");
                } else {
                    console.error("Failed");
                }
            } catch (error) {
                console.error("Error :", error);
            }
    });
</script> 

<script>
    document.getElementById("addfunds").addEventListener("submit", async (event) => {
        event.preventDefault();
        const formData = new FormData(event.target);
        function getQueryParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Get userId from the query parameter
        const userId = getQueryParameter('userId');
        formData.append('user', userId);

            try {
                const response = await fetch("https://server-9l60.onrender.com/addfund", {
                    method: "POST",
                    body: formData,
                });

                if (response.ok) {
                    window.location.href = "https://mahadevstarline.github.io/site/dashboard";
                    console.log("Amount Added");
                } else {
                    console.error("Failed");
                }
            } catch (error) {
                console.error("Error :", error);
            }
    });
</script>


<script>
    document.getElementById("withdrawfunds").addEventListener("submit", async (event) => {
        event.preventDefault();
        
        const formData = new FormData(event.target);
        var amt = -formData.get('amount');
        function getQueryParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Get userId from the query parameter
        const userId = getQueryParameter('userId');
        formData.append('user', userId);
        formData.set('amount', amt);

            try {
                const response = await fetch("https://server-9l60.onrender.com/addfund", {
                    method: "POST",
                    body: formData,
                });

                if (response.ok) {
                    window.location.href = "https://mahadevstarline.github.io/site/dashboard";
                    console.log("Amount Added");
                } else {
                    console.error("Failed");
                }
            } catch (error) {
                console.error("Error :", error);
            }
    });
</script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js";
        import {  getFirestore, collection,doc, query, where, getDocs } from 'https://www.gstatic.com/firebasejs/9.6.6/firebase-firestore.js';

        // Function to extract query parameter from the URL
        function getQueryParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Get userId from the query parameter
        const userId = getQueryParameter('userId');
        async function populateFormFields() {
            const firebaseConfig = {
                apiKey: "AIzaSyDGzXuv1re9hpOqykP6hDH2qWVMBCtbOJE",
  authDomain: "mahadev-efece.firebaseapp.com",
  projectId: "mahadev-efece",
  storageBucket: "mahadev-efece.appspot.com",
  messagingSenderId: "483675302264",
  appId: "1:483675302264:web:c72b4b367de8817f84c08d",
  measurementId: "G-0907T7GTET"
            };
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);                            

            

            try {
                
                    var approved,createdTimestamp, userCredits,phone , upi,username;
                    const settingsRef = collection(db, 'users');
                    const q = query(settingsRef, where('userId', '==', userId));
                    const querySnapshot = await getDocs(q);
                    const button = document.createElement('button');

                    // Append the button to the specified div element
                    const divElement = document.querySelector('.mb-2');
                    divElement.appendChild(button);
                    querySnapshot.forEach(doc => {
                        approved = doc.data().approved;
                        if(approved === true)
                        {
                            button.classList.add("btn", "btn-success", "btn-sm" ,"w-lg");
                            button.innerText = "Approved";
                        }
                        else
                        {
                            button.classList.add("btn", "btn-danger", "btn-sm" ,"w-lg");
                            button.innerText = "Unapproved";
                        }
                        button.onclick = async function() {
                            var formData = new FormData();
                            formData.append('userId',userId);
                            try {
                                const response = await fetch("https://server-9l60.onrender.com/appunapp", {
                                    method: "POST",
                                    body: formData,
                                });
                
                                if (response.ok) {
                                    window.location.reload();
                                    console.log("Status Changed");
                                } else {
                                    console.error("Failed");
                                }
                            } catch (error) {
                                console.error("Error :", error);
                            }

                        };
                        createdTimestamp = doc.data().createdTimestamp;
                        userCredits = doc.data().userCredits;
                        phone = doc.data().phone;
                        upi = doc.data().upi;
                        username = doc.data().username;
                        const table = document.getElementById("detail");
                        const nameElement = document.getElementById('priname');
                        const phoneElement = document.getElementById('priphone');
                        const balance = document.getElementById('cpoint');

                        // Update the inner text of the elements
                        nameElement.innerText = username;
                        phoneElement.innerText = phone.substring(3);
                        balance.innerText = userCredits;
                        const wlink = phone.replace(/\D/g, '');
                        const wl = 'https://wa.me/'+wlink;
                        const ml = 'tel:'+phone;

                        // Data for the rows
                        const rowData = [
                            { label: "Full Name :", value: username },
                            { label: "Mobile :", value: phone , actions: [
                                { icon: "mdi-cellphone-iphone", link: ml },
                                { icon: "mdi-whatsapp", link: wl }
                            ] },
                            { label: "Creation Date :", value: createdTimestamp.toDate().toDateString() },
                            { label: "Upi :", value: upi }
                        ];
                        rowData.forEach(dat => {
                            // Create a new table row (<tr>)
                            const newRow = document.createElement("tr");
                        
                            // Create a table header cell (<th>) for the label
                            const labelCell = document.createElement("th");
                            labelCell.setAttribute("scope", "row");
                            labelCell.textContent = dat.label;
                        
                            // Create a table data cell (<td>) for the value
                            const valueCell = document.createElement("td");
                            valueCell.textContent = dat.value;
                        
                            // If actions are provided, create links with icons in the value cell
                            if (dat.actions) {
                                dat.actions.forEach(action => {
                                    const icon = document.createElement("i");
                                    icon.classList.add("mdi", action.icon);
                                    const link = document.createElement("a");
                                    link.href = action.link;
                                    link.target = "_blank";
                                    link.appendChild(icon);
                        
                                    valueCell.appendChild(link);
                                });
                            }
                        
                            // Append the cells to the row
                            newRow.appendChild(labelCell);
                            newRow.appendChild(valueCell);
                        
                            // Append the row to the table
                            table.appendChild(newRow);
                        });

                    });

                    const settingsRefrr = collection(db, 'deposit');
                    const qrr = query(settingsRefrr, where('mno', '==', phone));
                    const querySnapshotrr = await getDocs(qrr);
                    const tableBody = document.getElementById('user_fund_deposit').getElementsByTagName('tbody')[0];
                    tableBody.innerHTML = ''; // Clear the table body before populating new data
                    let rowNumber = 1;
                    if (!querySnapshotrr.empty) {
                    querySnapshotrr.forEach(doc => {
                        const data = doc.data();
                        const { credits,timestamp,username } = data;
                        const newRow = tableBody.insertRow();
                        
                        const cellNumber = newRow.insertCell();
                        const celltime = newRow.insertCell();
                        const cellcredits = newRow.insertCell();
                        
                        cellNumber.textContent = rowNumber++;
                        if (createdTimestamp.toDate) {
                            celltime.textContent = createdTimestamp.toDate().toDateString().substring(0, 11);
                        } else {
                            celltime.textContent = "N/A"; // Display N/A or any other default value
                        }
                    
                        cellcredits.textContent = credits;
                        });
                    }
                    const settingsRefr = doc(db, 'bid_history', userId);
                    const winsCollectionRef = collection(settingsRefr, 'bids');
                    const qr = query(winsCollectionRef);
                    const querySnapshotr = await getDocs(qr);

                    const tableBodyr = document.getElementById('bidHistoryTable').getElementsByTagName('tbody')[0];
                    tableBodyr.innerHTML = ''; // Clear the table body before populating new data
            
                    let rowNumberr = 1;
                    if (!querySnapshotr.empty) {
                    querySnapshotr.forEach(doc => {
                        const data = doc.data();
                        const { game_name,timestamp, points,oc , type } = data;
                        const newRow = tableBodyr.insertRow();
                        
                        const cellNumber = newRow.insertCell();
                        const celldate = newRow.insertCell();
                        const cellgame = newRow.insertCell();
                        const celltype = newRow.insertCell();
                        const cellsession = newRow.insertCell();
                        const cellpoint = newRow.insertCell();
                        cellNumber.textContent = rowNumberr++;
                        celldate.textContent = timestamp.toDate().toDateString().substring(0,11);
                        cellgame.textContent = game_name;
                        celltype.textContent = type;
                        cellsession.textContent = oc;
                        cellpoint.textContent = points;
                        
                });
            }
                    const settingsRefrrr = doc(db, 'win_history',userId);
                    const winssCollectionRef = collection(settingsRefrrr, 'wins');
                    const qrrr = query(winssCollectionRef);
                    const querySnapshott = await getDocs(qrrr);
                    const tableBod = document.getElementById('winsHistory').getElementsByTagName('tbody')[0];
                    tableBod.innerHTML = ''; // Clear the table body before populating new data
            
                    let rowNumberrrr = 1;
                    if (!querySnapshott.empty) {
                    querySnapshott.forEach(doc => {
                        const data = doc.data();
                        const {  game_name,timestamp, points,oc , type } = data;
                        const newRow = tableBod.insertRow();
                        
                        const cellNumber = newRow.insertCell();
                        const celldate = newRow.insertCell();
                        const cellgame = newRow.insertCell();
                        const celltype = newRow.insertCell();
                        const cellsession = newRow.insertCell();
                        const cellpoint = newRow.insertCell();
                        
                        cellNumber.textContent = rowNumberrrr++;
                        celldate.textContent = timestamp.toDate().toDateString().substring(0,11);
                        cellgame.textContent = game_name;
                        celltype.textContent = type;
                        cellsession.textContent = oc;
                        cellpoint.textContent = points;
                        
                });
            }

            const settaaingsRef = collection(db, 'withdraw_points');
            const aq = query(settaaingsRef, where("userId",'==',userId));
            const aquerySnapshot = await getDocs(aq);
            const atableBody = document.getElementById('withdrawTable').getElementsByTagName('tbody')[0];
            atableBody.innerHTML = ''; // Clear the table body before populating new data
    
            let arowNumber = 1;
            if (!aquerySnapshot.empty) {
                aquerySnapshot.forEach(doc => {
                    const data = doc.data();
                    const {  createdTimestamp, points,state } = data;
                    const newRow = atableBody.insertRow();
                    
                    const cellNumber = newRow.insertCell();
                    const cellpoint = newRow.insertCell();
                    const celldate = newRow.insertCell();
                    const cellstatus = newRow.insertCell();
                   
                    cellNumber.textContent = arowNumber++;
                    cellpoint.textContent = points;
                    celldate.textContent = createdTimestamp.toDate().toDateString().substring(0,11);
                    if(state == 0)
                    {
                        const butt = document.createElement('button');
                        butt.textContent ='Pending';
                        butt.classList.add('btn', 'btn-success', 'btn-sm', 'w-lg', 'btn-block');
                        butt.style.backgroundColor = '#3F8AE2'
                        butt.style.borderColor = '#3F8AE2'
                        butt.style.width = butt.scrollWidth + 'px';
                        cellstatus.appendChild(butt);
                    }
                    if(state == 1)
                    {
                        const buttn = document.createElement('button');
                        buttn.textContent ='Rejected';
                        buttn.classList.add('btn', 'btn-danger', 'btn-sm', 'w-lg', 'btn-block');
                        buttn.style.width = buttn.scrollWidth + 'px';
                        cellstatus.appendChild(buttn);
                    }
                    if(state == 2)
                    {
                        const butt = document.createElement('button');
                        butt.textContent ='Approved';
                        butt.classList.add('btn', 'btn-success', 'btn-sm', 'w-lg', 'btn-block');
                        butt.style.width = butt.scrollWidth + 'px';
                        cellstatus.appendChild(butt);
                    }
                    
            });
            }
        } catch (error) {
            console.error('Error getting document:', error);
        }   
    }
    
    // Call the function to populate form fields
        populateFormFields();   
    </script>

   
    
    <script src="https://mahadevstarline.github.io/site/assets/js/pages/datatables.init.js"></script>
    <script src="https://mahadevstarline.github.io/site/assets/libs/datatables/datatables.min.js"></script>
    <script src="https://mahadevstarline.github.io/site/assets/js/pages/dashboard.init.js"></script>
    <script src="https://mahadevstarline.github.io/site/assets/js/custom.js"></script>

<!-- App js -->
<script src="https://mahadevstarline.github.io/site/assets/js/app.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.0/js/toastr.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"
            integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        $(document).ready(function () {
            toastr.options.timeOut = 10000;
                    });

    </script>
    </body>

</html>


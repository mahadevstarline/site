<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8"/>
    <title>  Dashboards  | Skote - Admin & Dashboard Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description"/>
    <meta content="Themesbrand" name="author"/>
    <!-- App favicon -->
    <link rel="shortcut icon" href="https://mahadevstarline.github.io/site/assets/images/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@6.5.95/css/materialdesignicons.min.css"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.0/css/toastr.css" rel="stylesheet"/>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"
          integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>

<link href="https://mahadevstarline.github.io/site/assets/libs/select2/select2.min.css" rel="stylesheet" type="text/css"/>

<!-- Bootstrap Css -->
<link href="https://mahadevstarline.github.io/site/assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
<!-- Icons Css -->
<link href="https://mahadevstarline.github.io/site/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
<!-- App Css-->
<link href="https://mahadevstarline.github.io/site/assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />
<!-- Bootstrap Css -->
    <link href="https://mahadevstarline.github.io/site/assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet"
          type="text/css"/>
    <!-- Icons Css -->
    <link href="https://mahadevstarline.github.io/site/assets/css/icons.min.css" rel="stylesheet" type="text/css"/>
    <!-- App Css-->
    <link href="https://mahadevstarline.github.io/site/assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css"/>
    <link href="https://mahadevstarline.github.io/site/assets/css/custom.css" id="app-style" rel="stylesheet" type="text/css"/>

</head>

    <body data-sidebar="dark">
        <!-- Begin page -->
    <div id="layout-wrapper">
    <header id="page-topbar">
    <div class="navbar-header">
        <div class="d-flex">
            <!-- LOGO -->
            <div class="navbar-brand-box">
                <a href="https://mahadevstarline.github.io/site/" class="logo logo-dark">
                    <span class="logo-sm">
                        <img src="https://mahadevstarline.github.io/site/assets/images/users/logo.png" alt="" height="40">
                    </span>
                    <span class="logo-lg">
                        <img src="https://mahadevstarline.github.io/site/assets/images/users/name.png" alt="" height="40">
                    </span>
                </a>

                <a href="https://mahadevstarline.github.io/site/" class="logo logo-light">
                    <span class="logo-sm">
                        <img src="https://mahadevstarline.github.io/site/assets/images/users/logo.png" alt="" height="40">
                    </span>
                    <span class="logo-lg">
                        <img src="https://mahadevstarline.github.io/site/assets/images/users/name.png" alt="" height="40">
                    </span>
                </a>
            </div>

            <button type="button" class="btn btn-sm px-3 font-size-16 header-item waves-effect" id="vertical-menu-btn">
                <i class="fa fa-fw fa-bars"></i>
            </button>

            <!-- App Search-->
        </div>

        <div class="d-flex">


            <div class="dropdown d-inline-block">
                <button type="button" class="btn header-item waves-effect" id="page-header-user-dropdown"
                        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <img class="rounded-circle header-profile-user"
                         src="https://mahadevstarline.github.io/site/assets/images/users/avatar-1.jpg"
                         alt="Header Avatar">
                    <span class="d-none d-xl-inline-block ms-1" key="t-henry">Kalyan Matka</span>
                    <i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
                </button>
                <div class="dropdown-menu dropdown-menu-end">
                    <!-- item-->

                    <a class="dropdown-item d-block" href="#" data-bs-toggle="modal"
                       data-bs-target=".change-password"><i class="bx bx-wrench font-size-16 align-middle me-1"></i> <span>Change Password</span></a>

                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item text-danger" href="javascript:void();" onclick="logout()"><i class="bx bx-power-off font-size-16 align-middle me-1 text-danger"></i> <span key="t-logout">Logout</span></a>

                    <!-- Your existing HTML elements for Firebase authentication (initialize Firebase SDK, login form, etc.) -->

                    <script type="module" src="https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js"></script>
                    <script type="module" src="https://www.gstatic.com/firebasejs/9.6.6/firebase-auth.js"></script>
                    <script type="module" src="https://www.gstatic.com/firebasejs/9.6.6/firebase-firestore.js"></script>

                    <!-- Your custom JavaScript code -->
                    <script type="module" src="https://mahadevstarline.github.io/site/services/firebase.js"></script>
                    <script type="module">
                        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js";
                        import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-auth.js";
                      
                        // Firebase configuration
                        const firebaseConfig = {
                            apiKey: "AIzaSyDGzXuv1re9hpOqykP6hDH2qWVMBCtbOJE",
  authDomain: "mahadev-efece.firebaseapp.com",
  projectId: "mahadev-efece",
  storageBucket: "mahadev-efece.appspot.com",
  messagingSenderId: "483675302264",
  appId: "1:483675302264:web:c72b4b367de8817f84c08d",
  measurementId: "G-0907T7GTET"
                        };
                      
                        // Initialize Firebase
                        const app = initializeApp(firebaseConfig);
                        const auth = getAuth(app);
                      
                        // Function to handle Firebase logout
                        window.logout = function(){
                          signOut(auth)
                            .then(() => {
                              // Sign-out successful. Redirect or perform any additional actions here.
                              window.location.href = "https://mahadevstarline.github.io/site/";
                              console.log("User signed out successfully");
                            })
                            .catch(error => {
                              // An error happened. Handle the error here.
                              console.error("Error during logout:", error);
                            });
                        }
                      
                        // Your existing code for handling authentication (login, etc.)
                      </script>
                    </div>
            </div>

            <div class="dropdown d-inline-block">
                <button type="button" class="btn header-item noti-icon right-bar-toggle waves-effect">
                    <i class="bx bx-cog bx-spin"></i>
                </button>
            </div>

        </div>
    </div>
</header>

<!--  Change-Password example -->
<div class="modal fade change-password" tabindex="-1" role="dialog"
     aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="myLargeModalLabel">Change Password</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"
                        aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="change-password">
                    <div class="mb-3">
                        <label for="current_password">Current Password</label>
                        <input id="current-password" type="password"
                               class="form-control "
                               name="current_password" autocomplete="current_password"
                               placeholder="Enter Current Password" value="">
                    </div>

                    <div class="mb-3">
                        <label for="newpassword">New Password</label>
                        <input id="password" type="password"
                               class="form-control " name="password"
                               autocomplete="new_password" placeholder="Enter New Password">
                    </div>

                    <div class="mb-3">
                        <label for="userpassword">Confirm Password</label>
                        <input id="password-confirm" type="password" class="form-control" name="password_confirmation"
                               autocomplete="new_password" placeholder="Enter New Confirm password">
                    </div>

                    <div class="mt-3 d-grid">
                        <button class="btn btn-primary waves-effect waves-light UpdatePassword"
                                data-id="1"
                                type="submit">Update Password
                        </button>
                    </div>
                </form>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
    <!-- ========== Left Sidebar Start ========== -->
    <div class="vertical-menu">

        <div data-simplebar class="h-100">
    
            <!--- Sidemenu -->
            <div id="sidebar-menu">
                <!-- Left Menu Start -->
                <ul class="metismenu list-unstyled" id="side-menu">
    
                    <li>
                        <a href="https://mahadevstarline.github.io/site/dashboard" class="waves-effect">
                            <i class="bx bx-home-circle"></i>
                            <span>Home</span>
                        </a>
                    </li>
    
    
                    <li>
                        <a href="https://mahadevstarline.github.io/site/user/userList.html" class="waves-effect">
                            <i class="bx bxs-user-detail"></i>
                            <span>User Management</span>
                        </a>
                    </li>
    
    
                    <li>
    
                        <a href="https://mahadevstarline.github.io/site/markets/result.html" class="waves-effect">
                            <i class="bx bx-bullseye"></i>
                            <span>Declare Result</span>
                        </a>
                    </li>
    
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bxs-report"></i>
                            <span>Report Management</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="true">
    
                            <li><a href="https://mahadevstarline.github.io/site/reports/bids.html">Users Bid History</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/reports/sell.html">Customer Sell Report</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/reports/wins.html">Winning Report</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/reports/w_report.html">Bid Win Report</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/reports/deposit_report.html">Auto Deposit History</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bxs-wallet"></i>
                            <span>Wallet Management</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="true">
    
                            <li><a href="https://mahadevstarline.github.io/site/wallet/withdraw_list.html">Withdraw Request</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/wallet/show_add_funds.html">Add Fund (User Wallet)</a></li>
                            
                        </ul>
                    </li>
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bx-bullseye"></i>
                            <span>Games Management</span>
                        </a>
    
                        <ul class="sub-menu" aria-expanded="true">
                            <li><a href="https://mahadevstarline.github.io/site/markets/game_name.html">Game Name</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/markets/game_rates.html">Game Rates</a></li>
                        </ul>
    
            
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bx-cog"></i>
                            <span>Settings</span>
                        </a>
    
                        <ul class="sub-menu" aria-expanded="true">
                            <li><a href="https://mahadevstarline.github.io/site/settings/main.html">Main Settings</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/settings/contact.html">Contact Settings</a></li>
                        </ul>
    
                    <li>
                        <a href="javascript: void(0);" class="has-arrow waves-effect">
                            <i class="bx bx-bullseye"></i>
                            <span>Starline Management</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="true">
                            <li><a href="https://mahadevstarline.github.io/site/starline/index.html">Game Name</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/starline_rate.html">Game Rates</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/bid_report.html">Bid History</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/show_result.html">Declare Result</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/sell_report.html">Starline Sell Report</a></li>
                            <li><a href="https://mahadevstarline.github.io/site/starline/win_report.html">Starline Winning Report</a></li>
                        </ul>
                    </li>
    
                </ul>
            </div>
        </div>
    </div>
    <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content">

            <div class="page-content">

                <div class="container-fluid">
                    
    <div class="row">

        <div class="card">

            <div class="card-header p-t-15 p-b-15">

            </div>

            <div class="card-body">
                <h5>Auto Deposit History</h5>
                <form class="theme-form mega-form" id="AutoDepositHistory" >
                    <div class="row">
                        <div class="form-group col-md-2" style="margin-top:auto;">

                            <label>Date</label>

                            <div class="input-group">

                                <input type="date" class="form-control" name="transaction_date"
                                       id="transaction_date"
                                       placeholder="Enter Start Date">

                            </div>

                        </div>

                        <div class="form-group col-md-2" style="align-self:flex-end;">

                            <button type="submit" class="btn btn-success waves-light m-t-25">Submit</button>

                        </div>

                    </div>
                </form>
            </div>

        </div>
        <button class="btn btn-primary" type="button"><i class="bx bxs-wallet-alt align-middle me-1"></i> <span
                    id="total_amount">
                        Total Amount 0
                    </span></button>

        <div class="card">

            <div class="card-header p-t-15 p-b-15">

            </div>

            <div class="card-body">
                <h5>Auto Deposit History List</h5>

                <div class="table-responsive">
                    <table id="depositHistory" class="table table-striped">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th>Date Time</th>
                            <th>User Phone</th>
                            <th>User Name</th>
                            <th>(₹) Amount</th>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

    


                </div>
                <!-- container-fluid -->
            </div>
            <!-- End Page-content -->
            <footer class="footer">
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-6">
                <script>document.write(new Date().getFullYear())</script> © Admin Panel.
            </div>
        </div>
    </div>
</footer>        </div>
        <!-- end main content-->
    </div>
    <!-- END layout-wrapper -->

    <!-- Right Sidebar -->
    <!-- Right Sidebar -->
<div class="right-bar">
    <div data-simplebar class="h-100">
        <div class="rightbar-title d-flex align-items-center px-3 py-4">
            
            <h5 class="m-0 me-2">Settings</h5>

            <a href="javascript:void(0);" class="right-bar-toggle ms-auto">
                <i class="mdi mdi-close noti-icon"></i>
            </a>
        </div>

        <!-- Settings -->
        <hr class="mt-0" />
        <h6 class="text-center mb-0">Choose Layouts</h6>

        <div class="p-4">
            <div class="mb-2">
                <img src="https://mahadevstarline.github.io/site/assets/images/layouts/layout-1.jpg" class="img-fluid img-thumbnail" alt="">
            </div>

            <div class="form-check form-switch mb-3">
                <input class="form-check-input theme-choice" type="checkbox" id="light-mode-switch" checked>
                <label class="form-check-label" for="light-mode-switch">Light Mode</label>
            </div>
    
            <div class="mb-2">
                <img src="https://mahadevstarline.github.io/site/assets/images/layouts/layout-2.jpg" class="img-fluid img-thumbnail" alt="">
            </div>
            <div class="form-check form-switch mb-3">
                <input class="form-check-input theme-choice" type="checkbox" id="dark-mode-switch" data-bsStyle="https://mahadevstarline.github.io/site/assets/css/bootstrap-dark.min.css" data-appStyle="https://mahadevstarline.github.io/site/assets/css/app-dark.min.css">
                <label class="form-check-label" for="dark-mode-switch">Dark Mode</label>
            </div>
    
            <div class="mb-2">
                <img src="https://mahadevstarline.github.io/site/assets/images/layouts/layout-3.jpg" class="img-fluid img-thumbnail" alt="">
            </div>
            <div class="form-check form-switch mb-5">
                <input class="form-check-input theme-choice" type="checkbox" id="rtl-mode-switch" data-appStyle="https://mahadevstarline.github.io/site/assets/css/app-rtl.min.css">
                <label class="form-check-label" for="rtl-mode-switch">RTL Mode</label>
            </div>

            <div class="mb-2">
                <img src="https://mahadevstarline.github.io/site/assets/images/layouts/layout-4.jpg" class="img-thumbnail" alt="layout images">
            </div>
            <div class="form-check form-switch mb-5">
                <input class="form-check-input theme-choice" type="checkbox" id="dark-rtl-mode-switch">
                <label class="form-check-label" for="dark-rtl-mode-switch">Dark RTL Mode</label>
            </div>
            
        </div>

    </div> <!-- end slimscroll-menu-->
</div>
<!-- /Right-bar -->

<!-- Right bar overlay-->
<div class="rightbar-overlay"></div>    <!-- /Right-bar -->

    <!-- JAVASCRIPT -->
    <!-- JAVASCRIPT -->
<script src="https://mahadevstarline.github.io/site/assets/libs/jquery/jquery.min.js"></script>
<script src="https://mahadevstarline.github.io/site/assets/libs/bootstrap/bootstrap.min.js"></script>
<script src="https://mahadevstarline.github.io/site/assets/libs/metismenu/metismenu.min.js"></script>
<script src="https://mahadevstarline.github.io/site/assets/libs/simplebar/simplebar.min.js"></script>
<script src="https://mahadevstarline.github.io/site/assets/libs/node-waves/node-waves.min.js"></script>
<script>
    document.getElementById("change-password").addEventListener("submit", async (event) => {
        event.preventDefault();
        const formData = new FormData(event.target);
        const newPassword = formData.get("password");

            try {
                const response = await fetch("https://server-9l60.onrender.com/change", {
                    method: "POST",
                    body: formData,
                });

                if (response.ok) {
                    window.location.href = "https://mahadevstarline.github.io/site/dashboard";
                    console.log("Password Changed");
                } else {
                    console.error("Failed");
                }
            } catch (error) {
                console.error("Error :", error);
            }
    });
</script>
<script type = "module">

    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js";
    import {  getFirestore, collection,doc, query,orderBy, where, getDocs } from 'https://www.gstatic.com/firebasejs/9.6.6/firebase-firestore.js';

    document.getElementById('AutoDepositHistory').onsubmit = function () {
        event.preventDefault();
        

        async function populateFormFields() {
            const firebaseConfig = {
                apiKey: "AIzaSyDGzXuv1re9hpOqykP6hDH2qWVMBCtbOJE",
  authDomain: "mahadev-efece.firebaseapp.com",
  projectId: "mahadev-efece",
  storageBucket: "mahadev-efece.appspot.com",
  messagingSenderId: "483675302264",
  appId: "1:483675302264:web:c72b4b367de8817f84c08d",
  measurementId: "G-0907T7GTET"
            };
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);                            

            

            try {
                
                var date = document.getElementById('transaction_date').value;
                    // Create a Date object for the specific date
                     // Replace '2023-10-19' with your specific date in the format 'YYYY-MM-DD'

                    // Create a Date object for 00:00 AM (midnight) of the specific date
                    const startOfDay = new Date(date);
                    startOfDay.setHours(0, 0, 0, 0); // Set hours, minutes, seconds, and milliseconds to 0

                    // Create a Date object for 23:59 PM of the specific date
                    const endOfDay = new Date(date);
                    endOfDay.setHours(23, 59, 59, 999); // Set hours, minutes, seconds, and milliseconds to end of the day

                    // Get timestamps for start of the day (00:00 AM) and end of the day (23:59 PM)
                    //const startTimestamp = startOfDay.getTime();
                    //const endTimestamp = endOfDay.getTime();

                    const settingsRef = collection(db, 'deposit');
                    const q = query(settingsRef, where('timestamp', '>=', startOfDay), where('timestamp', '<=', endOfDay), orderBy("timestamp","desc"));
                    const querySnapshot = await getDocs(q);
                    const tableBody = document.getElementById('depositHistory').getElementsByTagName('tbody')[0];
                    tableBody.innerHTML = ''; // Clear the table body before populating new data
                    var val = 0;
                    let rowNumber = 1;
                    if (!querySnapshot.empty) {
                        querySnapshot.forEach(doc => {
                            const data = doc.data();
                            const { credits,timestamp, mno,username, userId } = data;
                            const newRow = tableBody.insertRow();
                            
                            const cellNumber = newRow.insertCell();
                            const celldate = newRow.insertCell();
                            const cellmno = newRow.insertCell();
                            const cellusername = newRow.insertCell();
                            const cellcredits = newRow.insertCell();
                            
                            cellNumber.textContent = rowNumber++;
                            celldate.textContent = timestamp.toDate().getHours() + ":" + timestamp.toDate().getMinutes()+" " + timestamp.toDate().toDateString().substring(0,11);
                            cellmno.textContent = mno;
                            cellusername.textContent = username;
                            cellcredits.textContent = credits;
                            val=val+credits;
                            
                        });
                    }  
                    
                    document.getElementById('total_amount').innerHTML = 'Total Amount ' + val;
            } catch (error) {
                console.error('Error getting document:', error);
            }   
        }
    
    // Call the function to populate form fields
        populateFormFields();  
        
    };

</script>

    <script src="https://mahadevstarline.github.io/site/assets/js/custom.js"></script>
    <script src="https://mahadevstarline.github.io/site/assets/js/pages/dashboard.init.js"></script>
    <script src="https://mahadevstarline.github.io/site/assets/libs/select2/select2.min.js"></script>
    <script src="https://mahadevstarline.github.io/site/assets/libs/datatables/datatables.min.js"></script>
    <script>
        $(document).ready(function () {
            $.ajax({
                type: 'get',
                url: '/api/date',
                success: function (response) {
                    document.getElementById('transaction_date').value = response;
                }
            })
        })
    </script>

<!-- App js -->
<script src="https://mahadevstarline.github.io/site/assets/js/app.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.0/js/toastr.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"
            integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        $(document).ready(function () {
            toastr.options.timeOut = 10000;
                    });

    </script>
    </body>

</html>
